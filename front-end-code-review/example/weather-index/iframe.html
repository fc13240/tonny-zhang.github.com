<html>
<head>
<style>
body{padding:0;margin: 0}
</style>
<!--<script type="text/javascript" src="http://www.weather.com.cn/m2/j/shibo/caoyu-min.js"></script>
<script type="text/javascript" src="http://ad.321tq.com/ex2?posid=i"></script>-->
<script type="text/javascript" src="../../n/j/core.js"></script>
</head>
<body>
	<script type="text/caoyu_ad" id="adposter_6087">WR_PARAMETER.WR_AD_DATA={"show":"true","type":"CODE","files":[{"file":null,"link":"","IsFlash":"img"}],"code":"%3Cscript+type%3D%22text%2Fjavascript%22%3ETQ_FillSlot%28%2710000_002_01%27%29%3B%3C%2Fscript%3E","closebutton":true,"closetime":false,"under_file":true,"under_or_up":true,"toppx":40,"width":"650","height":"90","width_under":20,"pagewidth":960,"min_screen_w":1024,"opacity":0.9,"staytime":5,"speed":2,"videotitle":"","bgcolor":"000","bdcolor":"000","filepath":"http:\/\/poster.weather.com.cn\/p_files\/player\/player.swf","autostart":true,"repeat":"none","ratingimg":"http:\/\/poster.weather.com.cn\/a.gif?i=&p=6087&pos=0&ch=9991&act=1321&order=641&contract=182&host=153&ck=18375","direct":[]};WRATING.PLAY.ACTION(WR_PARAMETER.WR_AD_DATA);
			</script>
<script>
function load (js,callback){
	if(({}).toString.call(js) != "[object Array]"){
		js = [js];
	}
	var code = [];
	var len = js.length;
	var loadedNum = 0;
	for(var i = 0;i<len;i++){
		(function(_index){
			$.get(js[_index],function(content){
				code[loadedNum] = content;
				if(++loadedNum == len){
					callback && callback(code);
				}
			},'text');
		})(i);
	}
}
W.use('jquery',function(){
	load(['../../n/j/ad/caoyu-min.js.txt','../../n/j/ad/ex2.js.txt'],function(code){
		code = code.join(';');
		// code = 'document.write = document.writeln = function(){};'+code;
		// code = 'window.onload = function(){alert(BAIDU_CLB_SETJSONADSLOT)};'+code;
		W(function(){
			var adCode = $('#adposter_6087').get(0);
			adCode = adCode.innerText||adCode.text;
			// adCode = '';
			var fn = function(){
				var ifrm = $('<iframe class="bgLoading" frameborder="1" scrolling="no" src="about:blank" style="background-color: #ccc;">')
							.attr('width',400).attr('height',100).appendTo($('body')).get(0);
				
				var doc = null;
				if(ifrm.contentDocument) { // Firefox, Opera
					doc = ifrm.contentDocument;
				} else if(ifrm.contentWindow) { // Internet Explorer
					doc = ifrm.contentWindow.document;
					var ie = true;
				} else if(ifrm.document) { // Others?
					doc = ifrm.document;
				}
				// code = '';
				// adCode = '';
				var srcHtml = '<script src="http://github.zk.com/front-end-code-review/example/weather-index/1.js"></'+'script>';
				doc.open();
				doc.write('<html><head><script>'+code+'</'+'script></head><body><script>'+adCode+'</'+'script>hello</body></html>');
				//thanks to http://antalpha.blogspot.com/2009/02/add-dynamic-content-to-iframe-ie-issues.html
				if (!ie) {
					doc.close();
				}
			}
			fn();
			fn();
		});
		
	});
})

// W.use(['http://www.weather.com.cn/m2/j/shibo/caoyu-min.js','http://ad.321tq.com/ex2?posid=i'],function(){
	
// });
// W(function(){
// 	var ifrm = $('<iframe class="bgLoading" frameborder="1" scrolling="no" style="background-color: #ccc;">').attr('width',400).attr('height',100).appendTo($('body')).get(0);
// 	var doc = ifrm.contentDocument || ifrm.contentWindow.document;
// 	window['test'] = function(msg){
// 		this.document.writeln(msg);
// 	}
// 	doc.open();
// 	// code = 'document.write=function(html){document.body.innerHTML += html;alert(html);};var load = '+load.toString()+';load(["http://www.weather.com.cn/m2/j/shibo/caoyu-min.js","http://ad.321tq.com/ex2?posid=i"],function(){'+code+'});';
// 	doc.write('<html><head><script></'+'script></head><body><script>parent.test.call(this,"hello");</'+'script></body></html>');
// 	doc.close();
// 	// doc.body.innerHTML = 'test';
// })

</script>
</body>
</html>